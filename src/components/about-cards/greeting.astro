---
import { DRESAN_EMAIL } from "@/constants/dresan-data"
import FakeMasonryItem from "@/components/fake-masonry-item.astro"
---

<FakeMasonryItem id="greeting" class="wrapper">
  <div class="skin-container-wrapper">
    <canvas id="skin-container" class="skin-container"></canvas>
  </div>
  <div class="message-list">
    <div class="message">¡Hola! 🖖🏼</div>
    <div class="message">Me llamo Javier Andrés</div>
    <div class="message">¡Pero puedes decirme Dresan!</div>
    <div class="message">
      Te dejo mi <a class="email-link" href=`mailto:${DRESAN_EMAIL}` target="_blank">correo</a>
      para ponernos en contacto 🫱🏼
    </div>
  </div>
</FakeMasonryItem>

<script>
  import { $ } from "@/utils/dom-selector"
  import * as skinview3d from "skinview3d"

  const skinContainer = $<HTMLCanvasElement>("#skin-container")!

  let skinViewer = new skinview3d.SkinViewer({
    canvas: skinContainer,
    width: 400,
    height: 550,
    zoom: 0.95,
    enableControls: false,
    animation: new skinview3d.WalkingAnimation(),
    skin: "/images/skin.png",
    cape: "/images/cape.png",
  })

  skinViewer.animation!.speed = 0.7
</script>

<style>
  .wrapper {
    position: relative;
  }

  .skin-container-wrapper {
    margin-inline: auto;
    inline-size: fit-content;
    block-size: 550px;
  }

  .skin-container {
    pointer-events: none;
  }

  .message-list {
    position: absolute;
    inset: 24px;
    inset-block-start: unset;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .message {
    inline-size: fit-content;
    padding: 4px 10px;
    background-color: hsl(var(--color-card-background-hls) / 0.8);
    border-radius: 4px 20px 20px 4px;
    text-wrap: pretty;
  }

  .message:first-of-type {
    border-top-left-radius: 20px;
  }

  .message:last-of-type {
    border-bottom-left-radius: 20px;
  }

  .email-link {
    --hover-color: hsl(0 95% 66%);
    text-decoration: underline;
  }

  [data-theme="light"] .email-link {
    --hover-color: hsl(1 93% 38%);
  }

  .email-link:hover {
    color: var(--hover-color);
  }

  @media screen and (max-width: 511px) {
    .skin-container-wrapper {
      block-size: 410px;
    }

    .skin-container {
      inline-size: 279px !important;
      block-size: 410px !important;
    }
  }
</style>
